


<!DOCTYPE html>
<html lang="">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <!-- responsive-->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Camera Model [ Bingo ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/elenore/css/elenore.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="/css/floekr.css">
    
  

  <!-- highlight -->
  <link rel="stylesheet" href="/highlight/styles/monokai-sublime.css">
  <script src="/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Navigation Bar -->
<nav id="navbar" class="navbar is-white is-fixed-top">
  <div id="specialShadow" class="el-special-shadow"></div>
  <div class="container">

    <!-- left side, always visible -->
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <!-- <strong>Bingo</strong> -->
        <i class="fa fa-lg fa-home"></i>
      </a>

      <!-- toggles the menu on touch devices -->
      <div id="navbarBurger" class="navbar-burger burger" data-target="navMenu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <!-- menu -->
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
          
            
            <a href="/" class="navbar-item">HOME</a>
            

            

            
          
            

            

            
            <a href="/projects" class="navbar-item" >PROJECTS</a>
            
          
            

            
            <a href="/about" class="navbar-item">ABOUT</a>
            

            
          
        </div>
    </div>
  </div>
</nav>

<!-- index hero -->
<div class="hero is-large has-background-fixed" id="indexHero">
  <div class="hero-body">
    <div class="container has-text-centered">
      <p id="titleContent">
        Bingo, <span>Computer Graphics</span> & <span>Game Developer</span>
      </p>
    </div>
  </div>
</div>

<!-- articles and about me -->
<!-- in the future -->
<section class="section">
	<div class="container">
		<div class="columns">
			<div class="column is-four-fifths">
				<div class="card is-white is-hover" id="postCard">
					<div class="card-header">
					  <h3 class="card-header-title">Camera Model</h3>
					</div>
					<div class="card-content">
					  <p><h3 id="Pinhole-Camera-Model"><a href="#Pinhole-Camera-Model" class="headerlink" title="Pinhole Camera Model"></a>Pinhole Camera Model</h3><blockquote>
<p>本文为在<a href="http://www.scratchapixel.com/lessons/3d-basic-rendering/3d-viewing-pinhole-camera" target="_blank" rel="noopener">Scratchapixel</a>上学习相机模型时的个人理解。本文不做翻译或搬运工作，只描述个人学习上的理解。</p>
</blockquote>
<blockquote>
<p>PS: 这一章略过Depth of field(景深)的概念</p>
</blockquote>
<p>易混淆概念解读</p>
<table>
<thead>
<tr>
<th>Camera Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Focal Length</td>
<td>eye到真实film平面的距离，与光圈一道用于计算FOV/AVO。焦距容易和虚拟相机中的虚拟film平面到eye之间的距离混淆，虚拟film平面一般位于近裁剪面</td>
</tr>
<tr>
<td>Camera Aperture</td>
<td>光圈定义了真实相机的物理维度，与焦距一道用于计算FOV/AVO。同时光圈的两个维度也定义了film gate aspect ratio大小。<a href="https://en.wikipedia.org/wiki/List_of_film_formats" target="_blank" rel="noopener">Wiki</a>中列举了大多数常见的film参数。</td>
</tr>
<tr>
<td>Clipping Planes</td>
<td>远近裁剪面是虚拟的平面，其位于摄像机的视锥体中，只有在远近裁剪面中的对象才会被渲染。由于画布经常与近裁剪面放置在一起，因此要提防与Focal Length概念混淆。</td>
</tr>
<tr>
<td>Image Size</td>
<td>输出图像的尺寸/像素，图像尺寸定义了resolution gate aspect ratio。</td>
</tr>
</tbody>
</table>
<p>由以上的这些概念可以推导计算出下面这些变量的值</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Decription</th>
</tr>
</thead>
<tbody>
<tr>
<td>Angle of View</td>
<td>由Focal Length与Film Size(Camera Aperture)计算得到</td>
</tr>
<tr>
<td>Canvas/Screen Window</td>
<td>其宽高比例与真实光圈定义得到的film gate aspect ratio一致，可以根据Canvas Size以及光圈快门宽高比例计算得到</td>
</tr>
<tr>
<td>Film Gate Aspect Ratio</td>
<td>$\frac{\text{film width}}{\text{film height}}$，这里film为真实相机的胶卷尺寸</td>
</tr>
<tr>
<td>Resolution Gate Aspect Ratio</td>
<td>$\frac{\text{image width}}{\text{image height}}$，这里image为输出的像素宽高比图像的</td>
</tr>
</tbody>
</table>
<p>光圈(Aperature):本质上，在平红相机模型中，光圈就是暗室上的那个小洞。但是在现实生活中光圈(pin hole camera model)有一系列的问题。</p>
<p>首先，较大的光圈将会产生模糊的图像(在物体上的同一个位置反射的光子有较大概率在背景布上重叠)，但可以大大增大进光量减少曝光时间(曝光时间越长，那么拍摄非静止物体就会模糊)。</p>
<p>然而，为了得到一个边缘清晰锐利可辨的图像，减小光圈直径又是必要的，但这也要求曝光时间增加来提高画面亮度，这也提高了画面模糊的概率。</p>
<blockquote>
<p>上述概念可由下两动图解释</p>
</blockquote>
<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/pinhole1.gif" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/pinhole1.gif" alt=""><br>    </a><br></figure>

<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/pinhole2.gif" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/pinhole2.gif" alt=""><br>    </a><br></figure>


<p>为了解决曝光时间和边缘锋利的矛盾，人们将平红相机的洞替换为了<code>凸透镜</code>。如图所示，更大的光圈可以带来更佳的进光量，减少曝光时间，同时，他也可以将一定距离内的物体上反射的光重新在背景布上汇聚(不同的焦距将会带来不同的景深)。</p>
<blockquote>
<p>景深表示在场景中，可见的最远的物体和最近的物体之间的距离(边缘锋利可辨)。因此平红相机的景深为无限大，因为他只是简单的讲光路重现在背景布上，不存在透镜相机的光路汇集的情况。</p>
</blockquote>
<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/lens.png" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/lens.png" alt=""><br>    </a><br></figure>

<p>视角(Angle of View/AOV, Field of View/FOV):视角与两个参数息息相关，底片尺寸与焦距。也就是说改变两者中的任何一个都会引起视角的变化。</p>
<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/filmsize3.png" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/filmsize3.png" alt=""><br>    </a><br></figure><br>&gt; 相同的焦距不同的底片大小将会导致最终图像的内容变少<br><br><figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/filmsize4.png" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/filmsize4.png" alt=""><br>    </a><br></figure>

<blockquote>
<p>同样的若想要在不同的底片大小上获得一致的内容，那么就要适当的调整焦距大小，这也就带来清晰度的影响。因为底片越大，相同的内容展示的也就越清晰。</p>
</blockquote>
<blockquote>
<p>同时这三个参数都是互相衔接的，也就是只要知道三者中的任何两个，就可以计算出剩下一个参数的大小。当然数字相机拍摄的画面已经不再受到底片的大小的影响了(传感器大小)。</p>
</blockquote>
<p>胶片框比例(File Gate Radio)与图像分辨率比例(Resolution Gate Ratio):这两者是很有可能不一致的，那么这时候你使用的相机就是变形镜头。 </p>
<blockquote>
<p>两者比例不同时，你可能面临画面选择的问题。因此Maya给出两个选项:过扫描(Oversan)和填充(Fill)如下图。</p>
</blockquote>
<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/filmgate3.png" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/filmgate3.png" alt=""><br>    </a><br></figure>

<p>基本未知量推导</p>
<figure><br>    <a href="http://www.scratchapixel.com/images/upload/cameras/canvascoordinates4.png" target="_blank" rel="noopener"><br>        <img src="http://www.scratchapixel.com/images/upload/cameras/canvascoordinates4.png" alt=""><br>    </a><br></figure>

<p>相机原点就可以理解为Eye所在位置</p>
<p>$$\begin{array}{l}<br>\tan({\theta_H \over 2}) &amp; = &amp; {A \over B} \\&amp; = &amp; \color{red}{\dfrac {\dfrac { (\text{Film Aperture Width} * 25.4) } { 2 } } { \text{Focal Length} }}.<br>\end{array}$$</p>
<blockquote>
<p>$\theta$是FOV(视角/视野)，可以通过$arctan(\frac{A}{B})$求解显示得到。</p>
</blockquote>
<blockquote>
<p>$Canvas Size$也就是所谓的近裁剪面，因此近裁剪面的位置不同，画布的大小也会随之改变。当近裁剪面位于$z = 0$位置时，相应计算而来的$Canvas Size = 0$</p>
</blockquote>
<p>$$\begin{array}{l}<br>\tan({\theta_H \over 2}) = {A \over B} =<br>\dfrac{\dfrac{\text{Canvas Width} } { 2 } } { Z_{near} }, \\<br>\dfrac{\text{Canvas Width} } { 2 } = \tan({\theta_H \over 2}) <em> Z_{near},\\<br>\text{Canvas Width}= 2 </em> \color{red}{\tan({\theta_H \over 2})} * Z_{near}.<br>\end{array}$$</p>
<blockquote>
<p>只要得到Canvas Size就可以通过aspect ratio以及简单的坐标变换得到[left, top, right, bottom]各自的值。</p>
</blockquote>
<p>$$\begin{array}{l}<br>\text{right} = \color{red}{\dfrac {\dfrac { (\text{Film Aperture Width} <em> 25.4) } { 2 } } { \text{Focal Length} }} </em> Z_{near}.<br>\end{array}$$</p>
<p>$$\text{top} = \color{red}{\dfrac {\dfrac { (\text{Film Aperture Height} <em> 25.4) } { 2 } } { \text{Focal Length} }} </em> Z_{near}.$$</p>
<hr>
<h3 id="PBRT中的相机坐标系变换"><a href="#PBRT中的相机坐标系变换" class="headerlink" title="PBRT中的相机坐标系变换"></a>PBRT中的相机坐标系变换</h3><ul>
<li>Camera Space: 以相机的origin作为坐标轴的中心，z轴作为视线方向，y轴作为抬头方向(up direction)，用于判断一个物体是否对于相机本身是否可见会非常的方便。</li>
<li>Screen Space: 屏幕空间本身是在图像面板上定义出的，尽管被称之为屏幕空间，但z值依然是有意义的(相关于远近裁剪面，其范围为$[0, 1]$)。</li>
<li>Normalized device coordinate(NDC) space : 这是一个真实图像被渲染的坐标系，xy的范围都在$[0, 1]$之间，z值和屏幕空间坐标系一样有效，本质上也就是屏幕空间线性转换而来。</li>
<li>Raster Space: 本质上他和NDC Space并没有太大的差别，唯独的区别就是他的xy范围在$[0, xResolution]$和$[0, yResolution]$</li>
</ul>
</p>
			        </div>
				</div>		
			</div>

			<div class="column">
				<div class="is-sticky">
					<div class="card is-white is-hover  is-hidden-mobile">
					  <div class="card-content">
					    <aside class="menu">
					      <p class="menu-label">
					        Archives
					      </p>
					      <ul class="menu-list">
					        <li><a>2016</a></li>
					        <li>
					          <a class="is-active">2017</a>
					          <ul>
					            <li><a>September</a></li>
					            <li><a>August</a></li>
					            <li><a>July</a></li>
					          </ul>
					        </li>
					        <li><a>2018</a></li>
					      </ul>
					    </aside>
					  </div>
					</div>

					<br>

					<div class="card is-white is-hover is-hidden-mobile">
					  <div class="card-content">
					    <aside class="menu">
					      <p class="menu-label">
					        Tags
					      </p>
					      <ul class="menu-list">
					        <li><a>Game</a></li>
					        <li>
					          <a class="is-active">Renderer</a>
					        </li>
					        <li><a>C++</a></li>
					        <li><a>Math</a></li>
					      </ul>
					    </aside>
					  </div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>


<!-- Footer -->
<footer class="footer is-medium" id="footerStyle">
  <div class="container">
    <nav class="level is-mobile">
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>

      <div class="level-item has-text-centered">
        <img src="https://yellowdi.github.io/Elenore/images/elenore-icon-outlined.png" alt="Elenore logo" width="50">
      </div>

      <div class="level-item has-text-centered">
        <img src="https://raw.githubusercontent.com/hexojs/logo/master/hexo-logo-avatar-transparent-background.png" alt="Hexo logo" width="50">
      </div>
      
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
      <div class="level-item has-text-centered"></div>
    </nav>

    <div class="columns has-text-centered">
      <div class="column">
        Theme Floekr developed By <a href="https://github.com/BentleyBlanks">Bingo</a>, powered by <a href="https://yellowdi.github.io/Elenore">Elenore</a> and <a href="https://hexo.io/">Hexo</a>
      </div>
    </div>

  </div>
</footer>


  <!-- scripts list from theme config.yml -->
  
    <script src="/js/floekr.js" language="javascript"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  

</body>
</html>
